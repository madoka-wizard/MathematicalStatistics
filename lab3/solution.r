# Ионин Василий Андреевич (вариант № 14)
# Лабораторная работа № 3

N <- 18
Y <- c(180, 158, 190, 180, 170, 175, 174, 167, 199, 190, 165, 170, 174, 182, 183, 167, 172, 175)
x_0 <- rep(1, N)
x_1 <- c(1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1)
x_2 <- c(170, 170, 175, 180, 170, 178, 175, 174, 193, 170, 178, 165, 198, 183, 178, 176, 181, 176)
x_3 <- c(170, 155, 195, 170, 165, 179, 163, 167, 173, 166, 156, 160, 176, 167, 172, 164, 187, 164)
x_4 <- c(72, 65, 80, 70, 60, 53, 65, 56, 85, 58, 55, 65, 50, 69, 94, 68, 65, 85)

############## Подзадача 1 ##############
# Метод наименьших квадратов
X <- matrix(c(x_0, x_1, x_2, x_3, x_4), N, 5)
B <- t(X) %*% X
theta <- solve(B) %*% t(X) %*% Y

sq <- function(x_1, x_2, x_3, x_4, y) {
  return(sum((y - (theta[1] +
    x_1 * theta[2] +
    x_2 * theta[3] +
    x_3 * theta[4] +
    x_4 * theta[5]))^2))
}